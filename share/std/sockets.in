module Sockets

socket :: Int -> Int -> Int -> IO
socket domain socktype protocol = do
  let fd = unsafeSocket domain, socktype, protocol
  IO{inner: fd}
end

bindSocket :: Int -> String -> Int -> IO
bindSocket fd host port = do
  unsafeBind fd, host, port
  IO{inner: 0}
end

listen :: Int -> Int -> IO
listen fd backlog = do
  unsafeListen fd, backlog
  IO{inner: 0}
end

accept :: Int -> IO
accept fd = do
  let client_fd = unsafeAccept fd
  IO{inner: client_fd}
end

connect :: Int -> String -> Int -> IO
connect fd host port = do
  unsafeConnect fd, host, port
  IO{inner: 0}
end

send :: Int -> String -> Int -> IO
send fd data flags = do
  let bytes = unsafeSend fd, data, flags
  IO{inner: bytes}
end

recv :: Int -> Int -> Int -> IO
recv fd size flags = do
  let data = unsafeRecv fd, size, flags
  IO{inner: data}
end

closeSocket :: Int -> IO
closeSocket fd = do
  unsafeCloseSocket fd
  IO{inner: 0}
end
