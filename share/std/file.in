module File

openFile :: String -> String -> IO<Int>
openFile path mode = do
  let fd = unsafeOpenFile path, mode
  IO<Int>{inner: fd}
end

readFile :: Int -> Int -> IO<String>
readFile fd size = do
  let content = unsafeReadFile fd, size
  IO<String>{inner: content}
end

writeFile :: Int -> String -> IO<Int>
writeFile fd content = do
  let bytes = unsafeWriteFile fd, content
  IO<Int>{inner: bytes}
end

closeFile :: Int -> IO<Int>
closeFile fd = do
  unsafeCloseFile fd
  IO<Int>{inner: 0}
end
